\chapter{6}{Faltning}

\begin{task}{6.1}
	Använd definitionen av faltning:
	\begin{align*}
	f*g(t)=
	&\int_{-\infty}^{+\infty}\! f(t-\tau)g(\tau)\, d\tau=
	\int_{-\infty}^{+\infty}\! e^{-(t-\tau)}\theta(t-\tau)e^{-3\tau}\theta(\tau)\, d\tau=
	\left(\int_{0}^{t}\! e^{-(t-\tau)-3\tau}\, d\tau\right)\theta(t)= \\ =
	&\left(\int_{0}^{t}\! e^{-t-2\tau}\, d\tau\right)\theta(t)=
	\left[-\frac{e^{-t-2\tau}}{2}\right]_0^t\theta(t)=
	\left(-\frac{e^{-3t}}{2}-\left(-\frac{e^{-t}}{2}\right)\right)\theta(t)=
	\frac{1}{2}(e^{-t}-e^{-3t})\theta(t)
	\end{align*}
	\ans $f*g(t)=\frac{1}{2}(e^{-t}-e^{-3t})\theta(t)$
\end{task}

\begin{task}{6.2}
	\begin{align*}
	\laplace f(s)=
	\laplace (e^{-t}\theta)(s)=
	\frac{1}{s+1}
	\end{align*}
	\begin{align*}
	\laplace g(s)=
	\laplace (e^{-3t}\theta)(s)=
	\frac{1}{s+3}
	\end{align*}
	\begin{align*}
	\laplace (f*g)(s)=
	\laplace (\frac{1}{2}(e^{-t}-e^{-3t})\theta)(s)=
	\frac{1}{2}\*\frac{1}{s+1}-\frac{1}{2}\*\frac{1}{s+3}=
	\frac{1}{(s+1)(s+3)}
	\end{align*}
\end{task}

\begin{task}{6.3}
	Gör ett variabelbyte i integralen för att bevisa lagen.
	\begin{align*}
	f*g(t)=
	&\int_{-\infty}^{+\infty}\!f(t-\tau)g(\tau)\, d\tau=
	\begin{bmatrix}
	x=t-\tau \\
	\tau=t-x \\
	d\tau=-dx
	\end{bmatrix}=
	-\int_{+\infty}^{-\infty}\!f(x)g(t-x)\, dx= \\ =
	&\int_{-\infty}^{+\infty}\!g(t-x)f(x)\, dx=
	g*f(t)\mproof
	\end{align*}
\end{task}

\begin{task}{6.4 a)}
	\[f*g(t)=\int_{-\infty}^{+\infty}\!f(t-\tau)g(\tau)\, d\tau\]
\end{task}

\begin{task}{6.4 b)}
	Låt $f\theta$ och $g\theta$ vara två kausala funktioner, definitionen av faltning ger då:
	\[(f\theta)*(g\theta)(t)=
	\int_{-\infty}^{+\infty}\!f(t-\tau)\theta(t-\tau)g(\tau)\theta(\tau)\, d\tau\]
	Eftersom $\theta(t-\tau)\theta(\tau)\equiv0\cond{t\le 0}$ och $\theta(t-\tau)\theta(\tau)=0\cond{0\le\tau\le t}\cond{t > 0}$ är:
	\[(f\theta)*(g\theta)(t)=\begin{linsys}{ll}
	\int_{0}^{t}\!f(t-\tau)g(\tau)\, d\tau&\cond{t\le0} \\
	0                                     &\cond{t>0}
	\end{linsys}\]
	Vilket också kan beskrivas som:
	\[(f\theta)*(g\theta)(t)=
	\left(\int_{0}^{t}\!f(t-\tau)g(\tau)\, d\tau\right)\theta(t)\]
\end{task}

\begin{task}{6.4 c)}
	Utnyttja definitionen av Laplacetransformen och faltning:
	\begin{align*}
	\laplace(f*g)(s)=
	&\int_{-\infty}^{+\infty}\!e^{-st}\left(\int_{-\infty}^{+\infty}\!f(t-\tau)g(\tau)\,d\tau\right)dt=
	\int_{-\infty}^{+\infty}\!\left(\int_{-\infty}^{+\infty}\!e^{-st}f(t-\tau)g(\tau)\,dt\right)d\tau= \\ =
	&\int_{-\infty}^{+\infty}\!e^{-s\tau}g(\tau)\left(\int_{-\infty}^{+\infty}\!e^{-s(t-\tau)}f(t-\tau)\,dt\right)d\tau=
	\begin{bmatrix}
	u=t-\tau \\
	du=dt
	\end{bmatrix}= \\ =
	&\int_{-\infty}^{+\infty}\!e^{-s\tau}g(\tau)\left(\int_{-\infty}^{+\infty}\!e^{-su}f(u)\,du\right)d\tau=
	\int_{-\infty}^{+\infty}\!e^{-s\tau}g(\tau)\laplace f(s)\, d\tau= \\ =
	&\laplace f(s)\int_{-\infty}^{+\infty}\!e^{-s\tau}g(\tau)\, d\tau=
	\laplace f(s)\*\laplace g(s)\mproof
	\end{align*}
\end{task}

\begin{task}{6.5}
	\[\laplace f(s)=\frac{2}{s^3},\qquad
	\laplace g(s)=\frac{24}{s^5}\]
	\begin{align*}
	\laplace v(s)=
	\laplace(f*g)(s)=
	\laplace f(s)\*\laplace g(s)=
	\frac{2}{s^3}\*\frac{24}{s^5}=
	\frac{48}{s^8}=\frac{1}{105}\*\frac{7!}{s^8}\llra
	\frac{t^{7}}{105}\theta(t)=
	v(t)
	\end{align*}
	\ans $v(t)=\dfrac{t^{7}}{105}\theta(t)$
\end{task}

\begin{task}{6.6}
	Använd regeln $\laplace (f*g)(s)=\laplace f(s)\*\laplace g(s)$:
	\[\laplace f(s)=\frac{1}{(s+3)^2},\qquad
	\laplace g(s)=\frac{1}{s+1}\]
	\begin{align*}
	\laplace(f*g)(s)=
	\laplace f(s)\*\laplace g(s)=
	\frac{1}{(s+3)^2}\*\frac{1}{s+1}=
	\frac{k_1}{(s+3)^2}+\frac{k_2}{s+3}+\frac{k_3}{s+1}
	\end{align*}
	Identifiera variablerna:
	\begin{align*}
	&k_1(s+1)+k_2(s+3)(s+1)+k_3(s+3)^2=1 \lra \\ \lra
	&k_1(s+1)+k_2(s^2+4s+3)+k_3(s^2+6s+9)=1 \lra \\ \lra
	&\begin{cases}
	k_2+k_3=0 \\
	k_1+4k_2+6k_3=0 \\
	k_1+3k_2+9k_3=1
	\end{cases} \lra
	\begin{cases}
	k_1=-\frac{1}{2} \\
	k_2=-\frac{1}{4} \\
	k_3=\frac{1}{4}
	\end{cases}
	\end{align*}
	\begin{align*}
	\laplace (f*g)(s)=
	-\frac{1}{2}\*\frac{1}{(s+3)^2}-\frac{1}{4}\*\frac{1}{s+3}+\frac{1}{4}\*\frac{1}{s+1} \llra
	&-\frac{1}{2}te^{-3t}\theta(t)-\frac{1}{4}e^{-3t}\theta(t)+\frac{1}{4}e^{-t}\theta(t)= \\ =
	&\frac{1}{4}(e^{-t}-(2t+1)e^{-3t})\theta(t)
	\end{align*}
	\ans $f*g(t)=\frac{1}{4}(e^{-t}-(2t+1)e^{-3t})\theta(t)$
\end{task}

\begin{task}{6.7}
	\begin{align*}
	\laplace (u*u)(s)=
	&\laplace u(s)\*\laplace u(s)=
	(\laplace u(s))^2=
	\frac{6}{(s+1)^4} \lra \\ \lra
	\laplace u(s)=
	&\pm\frac{\sqrt{6}}{(s+1)^2}=
	\pm\sqrt{6}\frac{1}{(s+1)^2}\llra
	\pm\sqrt{6}te^{-t}\theta(t)
	\end{align*}
	\ans $u(t)=\pm\sqrt{6}te^{-t}\theta(t)$
\end{task}

\begin{task}{6.8}
	Låt $G(s)=\laplace g(s)$ och $Y(s)=\laplace y(s) \lra \laplace y'(s)=sY(s)$.
	\[2(y*g)=y-y'+g\]
	Laplacetransformera ekvationen:
	\begin{align*}
	&2Y(s)G(s)=Y(s)-sY(s)+G(s) \lra
	2\frac{1}{s+1}Y(s)=(1-s)Y(s)+\frac{1}{s+1} \lra \\ \lra
	&\left(\frac{2}{s+1}-1+s\right)Y(s)=\frac{1}{s+1} \lra
	\frac{2-(s+1)+s(s+1)}{s+1}Y(s)=\frac{1}{s+1} \lra \\ \lra
	&\frac{s^2+1}{s+1}Y(s)=\frac{1}{s+1} \lra
	Y(s)=\frac{1}{s^2+1}
	\end{align*}
	Hitta inversen:
	\begin{align*}
	\laplace^{-1}Y(t)=y(t)=\sin(t)\theta(t)
	\end{align*}
	\ans $y(t)=\sin(t)\theta(t)$
\end{task}

\begin{task}{6.9 a)}
	Låt $Y(s)=\laplace(\theta y)(s)$.
	\[\laplace(\theta y'')(s)=s\laplace(\theta y')(s)-y'(0)=s(s\laplace(\theta y)(s)-y(0))-y'(0)=s^2Y(s)\]
	Multiplicera ekvationen med $\theta(t)$ och Laplacetransformera den:
	\begin{align*}
	&s^2Y(s)+Y(s)=F(s) \lra
	(s^2+1)Y(s)=F(s) \lra
	Y(s)=\frac{1}{s^2+1}F(s)
	\end{align*}
	\ans $Y(s)=\dfrac{1}{s^2+1}F(s)$
\end{task}


\begin{task}{b)}
	\[Y(s)=\frac{1}{s^2+1}F(s)\]
	Låt $H(s)=\laplace (h\theta)(s)=\dfrac{1}{s^2+1}$.
	\[h(t)\theta(t)=\sin(t)\theta(t) \lra h(t)=\sin(t)\cond{t > 0}\]
	Hitta inversen till ekvationen:
	\begin{align*}
	y(t)\theta(t)=(h*f(t))\theta(t)
	\end{align*}
	Använd definitionen av kausal faltning:
	\begin{align*}
	y(t)=
	\int_{0}^{t}\!h(t-\tau)f(t)\, d\tau=
	\int_{0}^{t}\!\sin(t-\tau)f(t)\, d\tau\cond{t>0}
	\end{align*}
	\ans $y(t)=\int_{0}^{t}\!\sin(t-\tau)f(t)\, d\tau\cond{t>0}$
\end{task}

\begin{task}{6.10}
	Låt $G(s)=\laplace(\cos\theta)(s)$ och $F(s)=\laplace(f\theta)(s)$.
	\[G(s)=\frac{s}{s^2+1}\]
	Använd definitionen av faltning baklänges:
	\begin{align*}
	\int_{0}^{t}\!\cos(t-\tau)f(\tau)\, d\tau=
	\int_{-\infty}^{+\infty}\!\cos(t-\tau)\theta(t-\tau)f(\tau)\theta(\tau)\, d\tau=
	\cos(t)\theta(t)*f(t)\theta(t)
	\end{align*}
	Sätt in i ekvationen:
	\[\cos(t)\theta(t)*f(t)\theta(t)=\sin(2t)\cond{t>0}\]
	Multiplicera ekvationen med $\theta(t)$ (notera att $\theta(t)\*\theta(t)=\theta(t)$):
	\[\cos(t)\theta(t)*f(t)\theta(t)=\sin(2t)\theta(t)\]
	Hitta Laplacetransformen:
	\begin{align*}
	&G(s)F(s)=\frac{2}{s^2+4} \lra
	\frac{s}{s^2+1}F(s)=\frac{2}{s^2+4} \lra \\ \lra
	&F(s)=
	\frac{2s^2+2}{s(s^2+4)}=
	\frac{k_1}{s}+\frac{k_2s+k_3}{s^2+4}
	\end{align*}
	Identifiera variablerna:
	\begin{align*}
	&k_1(s^2+4)+(k_2s+k_3)s=1 \lra
	\begin{cases}
	k_1+k_2=2 \\
	k_3=0 \\
	4k_1=2
	\end{cases} \lra
	\begin{cases}
	k_1=\frac{1}{2} \\
	k_2=\frac{3}{2} \\
	k_3=0
	\end{cases}
	\end{align*}
	\begin{align*}
	F(s)=
	\frac{1}{2}\left(\frac{1}{s}+3\frac{s}{s^2+4}\right) \llra
	\frac{1}{2}\left(\theta(t)+3\cos(2t)\theta(t)\right)=
	\frac{1}{2}\left(1+3\cos(2t)\right)\theta(t)
	\end{align*}
	\[f(t)\theta(t)=\frac{1}{2}\left(1+3\cos(2t)\right)\theta(t)\lra
	f(t)=\frac{1}{2}\left(1+3\cos(2t)\right)\cond{t>0}\]
	\ans $f(t)=\frac{1}{2}\left(1+3\cos(2t)\right)\cond{t>0}$
\end{task}